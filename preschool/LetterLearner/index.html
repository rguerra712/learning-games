<!DOCTYPE html>
<html>

<head>
    <title>Daily Puzzles</title>
    <link rel="stylesheet" type="text/css" href="css/letters.css" onkeypress="onLetterTyped" />
</head>

<body>
    <div class="flex-container options">
        <input id="isUpperCase" type="checkbox">UpperCase?</input>
        <br />
        <label>Casing Prefix?</label>
        <select id="casePrefix" name="prefix">
            <option value="none">None</option>
            <option value="bigAndLittle">Big, Little</option>
            <option value="upperAndLower">Upper, Lower</option>
        </select>
    </div>
    <div>
        <h1 id="currentLetter" class="flex-container letter" onkeypress="onLetterTyped" />
    </div>
</body>

<script type="text/javascript">
    document.addEventListener('keypress', function(e) {
    	const key = e.key;
        const currentLetter = document.getElementById('currentLetter');
        const isUpperCase = document.getElementById('isUpperCase').checked;
        currentLetter.innerHTML = isUpperCase ? key.toUpperCase() : key.toLowerCase();
        const prefix = key.length === 1 && key.match(/[a-zA-Z]/) ? getPrefix(isUpperCase) : '';
        speak(prefix, 1);
        speak(key, .75);
    });

    function getPrefix(isUpperCase) {
        const prefixChoiceSelector = document.getElementById('casePrefix');
        const prefixChoice = prefixChoiceSelector[prefixChoiceSelector.selectedIndex].value;
        if (isUpperCase) {
            switch (prefixChoice) {
                case 'bigAndLittle':
                    return 'big';
                case 'upperAndLower':
                    return 'upper case';
                default:
                    return '';
            }
        } else {
            switch (prefixChoice) {
                case 'bigAndLittle':
                    return 'little';
                case 'upperAndLower':
                    return 'lower case';
                default:
                    return '';
            }
        }
    }

    function speak(text, speed) {
        var msg = new SpeechSynthesisUtterance(text);
        msg.rate = speed || 1;
        speechSynthesis.speak(msg);
	}
</script>

</html>